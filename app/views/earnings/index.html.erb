<div class="earnings_index">
  <table class="table_base">
    <% @earnings.group_by(&:year).sort_by(&:first).reverse.each do |year, earnings| -%>
      <% earnings.sort_by(&:month).reverse.each_with_index do |earning, index| -%>
        <tr>
          <% if index.zero? -%>
            <td rowspan="<%= earnings.size %>" class="numeric">
              <%= year %>
            </td>
            <td rowspan="<%= earnings.size %>" class="numeric">
              <%= earnings.map(&:total).sum %>
            </td>
          <% end -%>
          <td class="numeric"><%= earning.month %></td>
          <td class="numeric"><%= earning.total %></td>
          <td><%= results_display(earning.results) %></td>
        </tr>
      <% end -%>
    <% end -%>
  </table>
</div>
